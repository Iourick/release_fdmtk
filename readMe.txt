This is working version of Keith project under debugger.